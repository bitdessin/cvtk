Object Classification
#####################

In this tutorial, we will explain how to build and use an object classification model
using deep learning.

Source Code Preparation
***********************

To generate Python source code for object classification,
use the :command:`cvtk create` command.
For those new to deep learning,
it is recommended to run the following command to generate simple source code.
he code generated by this command contains only the essential processes,
with all complex processes imported from the cvtk package.
This makes the source code easy to read and helps in understanding the flow of deep learning.


.. code-block:: sh
    
    cvtk create --script cls.py --task cls


The source code generated by the above command is simple but difficult to customize.
If you want to add various processes,
such as data augmentation, optimization algorithms, and loss functions,
run :command:`cvtk create` command with argument :command:`--module vanilla` to generate source code
that is complete using only the torch package functions.


.. code-block:: sh
    
    cvtk create --script cls.py --task cls --module vanilla




Model Training and Validation
*****************************

To train the model,
open the source code generated above and execute it
by providing training data, validation data,
and test data to the input of the :code:`train` function.
It can also be executed directly from the command line as follows:



.. code-block:: sh

    python cls.py train \
        --label ./data/fruits/label.txt \
        --train ./data/fruits/train.txt \
        --valid ./data/fruits/valid.txt \
        --test ./data/fruits/test.txt \
        --output_weights ./output/fruits.pth


The weights of the trained model will be saved in :file:`fruits.pth`,
and the loss and accuracy data during the training process
will be saved in :file:`fruits.train_stats.txt`.




Inference
*********

To perform inference using the constructed model,
refer to the :code:`inference` function in the source code.
It can also be executed directly from the command line as follows:


.. code-block:: sh

    python cls.py inference \
        --label ./data/fruits/label.txt \
        --data ./data/fruits/test.txt \
        --model_weights ./output/fruits.pth \
        --output ./output/fruits.inference_results.txt




